{"ast":null,"code":"import{useEffect,useState}from\"react\";import axios from\"axios\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Callback=()=>{const[token,setToken]=useState(\"\");const[userData,setUserData]=useState(null);useEffect(()=>{const hash=window.location.hash;let tokenFromLocalStorage=window.localStorage.getItem(\"token\");if(!tokenFromLocalStorage&&hash){const tokenFromHash=hash.substring(1).split(\"&\").find(elem=>elem.startsWith(\"access_token\"));if(tokenFromHash){tokenFromLocalStorage=tokenFromHash.split(\"=\")[1];window.localStorage.setItem(\"token\",tokenFromLocalStorage);}}setToken(tokenFromLocalStorage);},[token]);// useEffect to display personal user information on the web page\nuseEffect(()=>{const token=window.localStorage.getItem(\"token\");const base_url=\"https://api.spotify.com/v1/me\";const header_payload={Authorization:`Bearer ${token}`};axios.get(`${base_url}`,{headers:header_payload}).then(res=>{setUserData(res.data);}).catch(error=>{console.log(`Error occured while fetching user info: ${error}`);});});const handleLogOut=()=>{setToken(\"\");window.localStorage.removeItem(\"token\");window.location.href=\"/\";};if(!userData){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"This is the callback page.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"spotify-btn\",onClick:handleLogOut,children:\"Log out from Spotify\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Welcome, \",userData.display_name,\"!\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Spotify Profile:\",\" \",/*#__PURE__*/_jsx(\"a\",{href:userData.external_urls.spotify,target:\"_blank\",rel:\"noopener noreferrer\",children:\"Visit Profile\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Followers: \",userData.followers.total]}),/*#__PURE__*/_jsx(\"img\",{src:userData.images[0].url,alt:userData.display_name,width:userData.images[0].width,height:userData.images[0].height})]})]});};export default Callback;","map":{"version":3,"names":["useEffect","useState","axios","jsx","_jsx","jsxs","_jsxs","Callback","token","setToken","userData","setUserData","hash","window","location","tokenFromLocalStorage","localStorage","getItem","tokenFromHash","substring","split","find","elem","startsWith","setItem","base_url","header_payload","Authorization","get","headers","then","res","data","catch","error","console","log","handleLogOut","removeItem","href","children","className","onClick","display_name","external_urls","spotify","target","rel","followers","total","src","images","url","alt","width","height"],"sources":["/Users/godfather/Desktop/TUS School Stuff/spotify_web_api_project/frontend/src/pages/Callback.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { UserData } from \"../interfaces/UserData\";\nimport axios from \"axios\";\n\nconst Callback = () => {\n  const [token, setToken] = useState(\"\");\n  const [userData, setUserData] = useState<UserData | null>(null);\n  useEffect(() => {\n    const hash = window.location.hash;\n    let tokenFromLocalStorage = window.localStorage.getItem(\"token\") as string;\n\n    if (!tokenFromLocalStorage && hash) {\n      const tokenFromHash = hash\n        .substring(1)\n        .split(\"&\")\n        .find((elem) => elem.startsWith(\"access_token\"));\n\n      if (tokenFromHash) {\n        tokenFromLocalStorage = tokenFromHash.split(\"=\")[1];\n        window.localStorage.setItem(\"token\", tokenFromLocalStorage);\n      }\n    }\n    setToken(tokenFromLocalStorage);\n  }, [token]);\n\n  // useEffect to display personal user information on the web page\n  useEffect(() => {\n    const token = window.localStorage.getItem(\"token\");\n    const base_url = \"https://api.spotify.com/v1/me\";\n    const header_payload = {\n      Authorization: `Bearer ${token}`,\n    };\n    axios\n      .get(`${base_url}`, { headers: header_payload })\n      .then((res) => {\n        setUserData(res.data);\n      })\n      .catch((error) => {\n        console.log(`Error occured while fetching user info: ${error}`);\n      });\n  });\n\n  const handleLogOut = () => {\n    setToken(\"\");\n    window.localStorage.removeItem(\"token\");\n    window.location.href = \"/\";\n  };\n\n  if (!userData) {\n    return <div>Loading...</div>;\n  }\n  return (\n    <div className=\"App\">\n      <h1>This is the callback page.</h1>\n      <button className=\"spotify-btn\" onClick={handleLogOut}>\n        Log out from Spotify\n      </button>\n      <div>\n        <h1>Welcome, {userData.display_name}!</h1>\n        <p>\n          Spotify Profile:{\" \"}\n          <a\n            href={userData.external_urls.spotify}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            Visit Profile\n          </a>\n        </p>\n        <p>Followers: {userData.followers.total}</p>\n        <img\n          src={userData.images[0].url}\n          alt={userData.display_name}\n          width={userData.images[0].width}\n          height={userData.images[0].height}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default Callback;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}